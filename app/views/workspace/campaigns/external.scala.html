@(user: Option[models.User], net: String, login:String, token:String)

@import workspace._
         
@import models._
@import helper._
@import org.joda.time.{DateTime, DateTimeUtils}

@import play.api.libs.ws.WS

@getCampaigns_yandex = @{
	val cList:Option[List[ShortCampaignInfo]] = API_yandex.getCampaignsList(login,token);
    cList.get    	
}

@main_workspace(user, nav = net) {

<div>
	<ul class="breadcrumb">
		<li><a href="#">Networks</a> <span class="divider">/</span></li>
		<li><a href="#">@net</a></li>
	</ul>
</div>

<div class="row-fluid sortable">		
				<div class="box span12">					
					<div class="box-content">
						<table class="table table-striped table-bordered bootstrap-datatable datatable">
						  <thead>
							  <tr>
								  <th>ID</th>
								  <th>Login</th>
								  <th>Token</th>
								  <th>Date registered</th>
								  <th>Rest</th>								  
								  <th>Actions</th>
							  </tr>
						  </thead>   
						  <tbody>						
						@getCampaigns_yandex.map{ case ci => 							
							<tr>
								<td>@ci.CampaignID</td>
								<td class="center">@login</td>
								<td class="center">@token</td>
								<td class="center">@ci.StartDate</td>
								<td class="center">@ci.Rest</td>								
								<td class="center">
									<a class="btn btn-info" id="@ci.CampaignID" 
									onclick="addCampaign(@ci.CampaignID, @DateTimeUtils.getInstantMillis(ci.StartDate), @ci.Rest)">										
										<i class="icon-edit icon-white"></i>  
										Add                                            
									</a>
								</td>
							</tr>												
						}
						  
						  </tbody>						  
					  </table> 					  
					</div>									
				</div>
				<a href="@routes.Networks.index(net)">
					<button class="btn btn-large btn-success pull-right" >Return</button>
				</a>
			</div> 
			
			
@** javascripts ***************************************************************@	
	<script type="text/javascript">        
        	function addCampaign(id,sd,db) {  
        		$.ajax({
        			type: 'POST',
        			url: "@routes.Workspace.postCampaign",        			
        			data: JSON.stringify({
        					user: '@user.get.name',
        					net: '@net',
        				 	_login: '@login',
        					_token: '@token',
        					network_campaign_id: id,
        					start_date: new Date(sd),        					
        					daily_budget: db	      			 				      				
        			}),
        			contentType:'application/json; charset=utf-8',
        			dataType : 'json',
        			success: function() {}
        		});        		
        	}
    </script>
@** javascripts ***************************************************************@	
			
}